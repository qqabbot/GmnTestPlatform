import{t as Q}from"./testCase-2de843ab.js";import{p as X}from"./project-b5d312e0.js";import{t as Y}from"./testModule-cc6cccac.js";import{e as Z}from"./environment-a944f101.js";import"./MonacoEditor.vue_vue_type_style_index_0_scoped_fcb97235_lang-9aa76e92.js";import{a as ee,r as _,l as le,q as te,b as n,o as u,f as m,d as l,w as e,E as c,g as r,e as f,c as i,F as I,C as V,h as S,t as k}from"./index-8b1ce721.js";import"./request-c7ccb34d.js";const oe={class:"test-execution"},ae={key:1,style:{"margin-top":"20px"}},ne={style:{display:"flex","align-items":"center",width:"100%","justify-content":"space-between","padding-right":"10px"}},se={style:{"font-weight":"bold"}},ue={style:{color:"#909399","font-size":"12px"}},de={class:"result-detail"},re={__name:"TestExecution",setup(ce){const F=_(!1),o=_({scope:"project",projectId:null,moduleId:null,envKey:""}),d=_([]),h=_([]),C=_([]),y=_([]),p=le(()=>({total:d.value.length,passed:d.value.filter(s=>s.status==="PASS").length,failed:d.value.filter(s=>s.status==="FAIL").length,skipped:d.value.filter(s=>s.status==="SKIP").length})),A=s=>({PASS:"success",FAIL:"danger",SKIP:"info"})[s]||"info",N=()=>{o.value.projectId=null,o.value.moduleId=null},K=async()=>{try{h.value=await X.getAll()}catch{c.error("Failed to load projects")}},M=async()=>{try{C.value=await Y.getAll()}catch{c.error("Failed to load modules")}},T=async()=>{try{y.value=await Z.getAll(),y.value.length>0&&(o.value.envKey=y.value[0].envName)}catch{c.error("Failed to load environments")}},B=async()=>{if(o.value.scope==="project"&&!o.value.projectId){c.warning("Please select a project");return}if(o.value.scope==="module"&&!o.value.moduleId){c.warning("Please select a module");return}F.value=!0,d.value=[];try{const s={envKey:o.value.envKey};o.value.scope==="project"?s.projectId=o.value.projectId:s.moduleId=o.value.moduleId;const a=await Q.execute(s);d.value=a;const g=(p.value.passed/p.value.total*100).toFixed(1);c.success(`Execution completed! Pass rate: ${g}%`)}catch{c.error("Execution failed")}finally{F.value=!1}};return te(()=>{K(),M(),T()}),(s,a)=>{const g=n("el-radio"),U=n("el-radio-group"),v=n("el-form-item"),w=n("el-option"),P=n("el-select"),z=n("VideoPlay"),x=n("el-icon"),L=n("el-button"),D=n("el-form"),b=n("el-statistic"),j=n("el-col"),W=n("SuccessFilled"),q=n("CircleCloseFilled"),R=n("WarningFilled"),$=n("el-row"),G=n("el-tag"),H=n("el-collapse-item"),J=n("el-collapse"),O=n("el-card");return u(),m("div",oe,[l(O,{class:"box-card"},{header:e(()=>[...a[4]||(a[4]=[r("span",null,"Test Execution",-1)])]),default:e(()=>[l(D,{model:o.value,"label-width":"120px"},{default:e(()=>[l(v,{label:"Scope"},{default:e(()=>[l(U,{modelValue:o.value.scope,"onUpdate:modelValue":a[0]||(a[0]=t=>o.value.scope=t),onChange:N},{default:e(()=>[l(g,{label:"project"},{default:e(()=>[...a[5]||(a[5]=[f("By Project",-1)])]),_:1}),l(g,{label:"module"},{default:e(()=>[...a[6]||(a[6]=[f("By Module",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),o.value.scope==="project"?(u(),i(v,{key:0,label:"Project"},{default:e(()=>[l(P,{modelValue:o.value.projectId,"onUpdate:modelValue":a[1]||(a[1]=t=>o.value.projectId=t),placeholder:"Select Project"},{default:e(()=>[(u(!0),m(I,null,V(h.value,t=>(u(),i(w,{key:t.id,label:t.projectName,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):S("",!0),o.value.scope==="module"?(u(),i(v,{key:1,label:"Module"},{default:e(()=>[l(P,{modelValue:o.value.moduleId,"onUpdate:modelValue":a[2]||(a[2]=t=>o.value.moduleId=t),placeholder:"Select Module"},{default:e(()=>[(u(!0),m(I,null,V(C.value,t=>(u(),i(w,{key:t.id,label:t.moduleName,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):S("",!0),l(v,{label:"Environment"},{default:e(()=>[l(P,{modelValue:o.value.envKey,"onUpdate:modelValue":a[3]||(a[3]=t=>o.value.envKey=t),placeholder:"Select environment"},{default:e(()=>[(u(!0),m(I,null,V(y.value,t=>(u(),i(w,{key:t.id,label:t.envName,value:t.envName},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(v,null,{default:e(()=>[l(L,{type:"primary",size:"large",onClick:B,loading:F.value},{default:e(()=>[l(x,null,{default:e(()=>[l(z)]),_:1}),a[7]||(a[7]=f(" Start Execution ",-1))]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"]),d.value.length>0?(u(),i($,{key:0,gutter:20},{default:e(()=>[l(j,{span:6},{default:e(()=>[l(b,{title:"Total Cases",value:p.value.total},null,8,["value"])]),_:1}),l(j,{span:6},{default:e(()=>[l(b,{title:"Passed",value:p.value.passed},{suffix:e(()=>[l(x,{style:{color:"#67c23a"}},{default:e(()=>[l(W)]),_:1})]),_:1},8,["value"])]),_:1}),l(j,{span:6},{default:e(()=>[l(b,{title:"Failed",value:p.value.failed},{suffix:e(()=>[l(x,{style:{color:"#f56c6c"}},{default:e(()=>[l(q)]),_:1})]),_:1},8,["value"])]),_:1}),l(j,{span:6},{default:e(()=>[l(b,{title:"Skipped",value:p.value.skipped},{suffix:e(()=>[l(x,{style:{color:"#909399"}},{default:e(()=>[l(R)]),_:1})]),_:1},8,["value"])]),_:1})]),_:1})):S("",!0),d.value.length>0?(u(),m("div",ae,[l(J,null,{default:e(()=>[(u(!0),m(I,null,V(d.value,(t,E)=>(u(),i(H,{key:E,name:E},{title:e(()=>[r("div",ne,[r("span",se,k(t.caseName),1),r("div",null,[l(G,{type:A(t.status),size:"small",style:{"margin-right":"10px"}},{default:e(()=>[f(k(t.status),1)]),_:2},1032,["type"]),r("span",ue,k(t.duration)+" ms",1)])])]),default:e(()=>[r("div",de,[r("p",null,[a[8]||(a[8]=r("strong",null,"Detail:",-1)),f(" "+k(t.detail),1)])])]),_:2},1032,["name"]))),128))]),_:1})])):S("",!0)]),_:1})])}}},ge=ee(re,[["__scopeId","data-v-b781fd10"]]);export{ge as default};
