import{t as y}from"./testCase-2de843ab.js";import{t as se}from"./testModule-cc6cccac.js";import{p as ue}from"./project-b5d312e0.js";import{a as de,r as n,l as A,q as ne,b as u,B as re,o as d,f as b,d as t,w as a,E as r,g as M,e as i,F as S,C as U,G as ie,c as g,t as ce,H as me}from"./index-8b1ce721.js";import"./request-c7ccb34d.js";const pe={class:"test-case-list"},ve={class:"card-header"},_e={class:"filter-section"},fe={__name:"TestCaseList",setup(ye){const N=n(!1),V=n(!1),C=n(""),w=n(null),p=n(null),T=n([]),x=n([]),P=n([]),o=n({caseName:"",projectId:null,moduleId:null,method:"GET",url:"",body:"",assertionScript:"status_code == 200",isActive:!0}),D=A(()=>o.value.projectId?x.value.filter(s=>s.project&&s.project.id===o.value.projectId):[]),L=A(()=>C.value?T.value.filter(s=>s.caseName.toLowerCase().includes(C.value.toLowerCase())):T.value),B=A(()=>w.value?x.value.filter(s=>s.project&&s.project.id===w.value):x.value),F=s=>({GET:"success",POST:"primary",PUT:"warning",DELETE:"danger"})[s]||"info",$=async()=>{try{P.value=await ue.getAll()}catch{r.error("Failed to load projects")}},G=async()=>{try{x.value=await se.getAll()}catch{r.error("Failed to load modules")}},O=()=>{p.value=null,v()},R=()=>{o.value.moduleId=null},v=async()=>{N.value=!0;try{if(p.value){const s=await y.getAll();T.value=s.filter(e=>e.module&&e.module.id===p.value)}else T.value=await y.getAll()}catch{r.error("Failed to load test cases")}finally{N.value=!1}},q=async()=>{try{if(!o.value.moduleId){r.warning("Please select a module");return}const s={...o.value,module:{id:o.value.moduleId}};o.value.id?(await y.update(o.value.id,s),r.success("Test case updated")):(await y.create(s),r.success("Test case created")),V.value=!1,v()}catch{r.error("Failed to save test case")}},z=async s=>{try{await me.confirm("Are you sure to delete this test case?","Warning",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}),await y.delete(s),r.success("Test case deleted"),v()}catch(e){e!=="cancel"&&r.error("Failed to delete test case")}},H=()=>{o.value={caseName:"",projectId:null,moduleId:null,method:"GET",url:"",body:"",assertionScript:"status_code == 200",isActive:!0}};return ne(()=>{$(),G(),v()}),(s,e)=>{const K=u("Plus"),E=u("el-icon"),_=u("el-button"),j=u("el-option"),h=u("el-select"),W=u("Search"),f=u("el-input"),m=u("el-table-column"),J=u("el-tag"),Q=u("el-switch"),X=u("Edit"),Y=u("Delete"),Z=u("el-table"),ee=u("el-card"),c=u("el-form-item"),I=u("el-radio"),le=u("el-radio-group"),te=u("el-form"),ae=u("el-dialog"),oe=re("loading");return d(),b("div",pe,[t(ee,{class:"box-card"},{header:a(()=>[M("div",ve,[e[14]||(e[14]=M("span",null,"Test Cases",-1)),t(_,{type:"primary",onClick:e[0]||(e[0]=l=>s.$router.push("/testing/cases/new"))},{default:a(()=>[t(E,null,{default:a(()=>[t(K)]),_:1}),e[13]||(e[13]=i(" New Case ",-1))]),_:1})])]),default:a(()=>[M("div",_e,[t(h,{modelValue:w.value,"onUpdate:modelValue":e[1]||(e[1]=l=>w.value=l),placeholder:"Select Project",style:{width:"200px","margin-right":"10px"},clearable:"",onChange:O},{default:a(()=>[(d(!0),b(S,null,U(P.value,l=>(d(),g(j,{key:l.id,label:l.projectName,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),t(h,{modelValue:p.value,"onUpdate:modelValue":e[2]||(e[2]=l=>p.value=l),placeholder:"Select Module",style:{width:"200px","margin-right":"10px"},clearable:"",onChange:v},{default:a(()=>[(d(!0),b(S,null,U(B.value,l=>(d(),g(j,{key:l.id,label:l.moduleName,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),t(f,{modelValue:C.value,"onUpdate:modelValue":e[3]||(e[3]=l=>C.value=l),placeholder:"Search cases...",style:{width:"300px"},clearable:""},{prefix:a(()=>[t(E,null,{default:a(()=>[t(W)]),_:1})]),_:1},8,["modelValue"])]),ie((d(),g(Z,{data:L.value,style:{width:"100%","margin-top":"20px"}},{default:a(()=>[t(m,{prop:"id",label:"ID",width:"80"}),t(m,{prop:"caseName",label:"Case Name","min-width":"200"}),t(m,{label:"Method",width:"100"},{default:a(({row:l})=>[t(J,{type:F(l.method),size:"small"},{default:a(()=>[i(ce(l.method),1)]),_:2},1032,["type"])]),_:1}),t(m,{prop:"url",label:"URL","min-width":"250","show-overflow-tooltip":""}),t(m,{label:"Status",width:"100"},{default:a(({row:l})=>[t(Q,{modelValue:l.isActive,"onUpdate:modelValue":k=>l.isActive=k},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(m,{label:"Actions",width:"150",fixed:"right"},{default:a(({row:l})=>[t(_,{type:"primary",size:"small",text:"",onClick:k=>s.$router.push(`/testing/cases/${l.id}/edit`)},{default:a(()=>[t(E,null,{default:a(()=>[t(X)]),_:1})]),_:1},8,["onClick"]),t(_,{type:"danger",size:"small",text:"",onClick:k=>z(l.id)},{default:a(()=>[t(E,null,{default:a(()=>[t(Y)]),_:1})]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[oe,N.value]])]),_:1}),t(ae,{modelValue:V.value,"onUpdate:modelValue":e[12]||(e[12]=l=>V.value=l),title:o.value.id?"Edit Test Case":"New Test Case",width:"800px",onClose:H},{footer:a(()=>[t(_,{onClick:e[11]||(e[11]=l=>V.value=!1)},{default:a(()=>[...e[19]||(e[19]=[i("Cancel",-1)])]),_:1}),t(_,{type:"primary",onClick:q},{default:a(()=>[...e[20]||(e[20]=[i("Save",-1)])]),_:1})]),default:a(()=>[t(te,{model:o.value,"label-width":"140px"},{default:a(()=>[t(c,{label:"Case Name"},{default:a(()=>[t(f,{modelValue:o.value.caseName,"onUpdate:modelValue":e[4]||(e[4]=l=>o.value.caseName=l)},null,8,["modelValue"])]),_:1}),t(c,{label:"Project"},{default:a(()=>[t(h,{modelValue:o.value.projectId,"onUpdate:modelValue":e[5]||(e[5]=l=>o.value.projectId=l),placeholder:"Select Project",onChange:R},{default:a(()=>[(d(!0),b(S,null,U(P.value,l=>(d(),g(j,{key:l.id,label:l.projectName,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(c,{label:"Module"},{default:a(()=>[t(h,{modelValue:o.value.moduleId,"onUpdate:modelValue":e[6]||(e[6]=l=>o.value.moduleId=l),placeholder:"Select Module",disabled:!o.value.projectId},{default:a(()=>[(d(!0),b(S,null,U(D.value,l=>(d(),g(j,{key:l.id,label:l.moduleName,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),t(c,{label:"HTTP Method"},{default:a(()=>[t(le,{modelValue:o.value.method,"onUpdate:modelValue":e[7]||(e[7]=l=>o.value.method=l)},{default:a(()=>[t(I,{label:"GET"},{default:a(()=>[...e[15]||(e[15]=[i("GET",-1)])]),_:1}),t(I,{label:"POST"},{default:a(()=>[...e[16]||(e[16]=[i("POST",-1)])]),_:1}),t(I,{label:"PUT"},{default:a(()=>[...e[17]||(e[17]=[i("PUT",-1)])]),_:1}),t(I,{label:"DELETE"},{default:a(()=>[...e[18]||(e[18]=[i("DELETE",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(c,{label:"Request URL"},{default:a(()=>[t(f,{modelValue:o.value.url,"onUpdate:modelValue":e[8]||(e[8]=l=>o.value.url=l)},null,8,["modelValue"])]),_:1}),t(c,{label:"Request Body"},{default:a(()=>[t(f,{modelValue:o.value.body,"onUpdate:modelValue":e[9]||(e[9]=l=>o.value.body=l),type:"textarea",rows:4,placeholder:'{"key": "value"}'},null,8,["modelValue"])]),_:1}),t(c,{label:"Assertion Script"},{default:a(()=>[t(f,{modelValue:o.value.assertionScript,"onUpdate:modelValue":e[10]||(e[10]=l=>o.value.assertionScript=l),type:"textarea",rows:3,placeholder:"status_code == 200"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},Te=de(fe,[["__scopeId","data-v-85ea1f1f"]]);export{Te as default};
